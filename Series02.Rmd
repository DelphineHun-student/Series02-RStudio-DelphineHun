---
title: "Series-02-Rstudio : Data mining and statistical tests"
author: "Delphine HUND"
date: "`r format(Sys.time(), '%d %B, %Y, %H:%M')`"
output:
  html_document:
    df_print: paged
    code_folding: hide
    toc: false
    number_sections: true
---
# Correlations and linear regression

In this series, the aim is to explore correlations and linear regression, using a dataset from a real experiment.

### The problem

We investigate whether there is a relationship between the nonuse of the proximal part of the upper limb (PANU) and the nonuse of the shoulder (SANU) or the elbow (EENU).

## Methods

### Dataset

The dataset is far from perfect, which reflects the reality of experimental research, particularly in clinical contexts.

```{r load data}
nonuse <- read.csv("data/test_data/NonUse.csv", sep=",", header=TRUE)
head(nonuse)
summary(nonuse)
```
### Variables
This file contains measures of upper extremity nonuse:

    PANU: Proximal Arm Non Use
    SANU: Shoulder Antepulsion Non Use
    EENU: Elbow Extension Non Use


Description of the experiment, the variables and the data (units and the range of possible values).

| name | description | unit | range
|---|-------|--|-----
| PANU | Proximal Arm Non Use | % | O-100 |
| SANU | Shoulder Antepulsion Non Use | % | O-100 |
| EENU | Elbow Extension Non Use | % | O-100 |

## Analyses

### Corelation analysis

- Correlation between PANU/SANU

We used a Spearman correlation, because we don't have assumptions about the distribution of the data. We do not assume linear relationship between variables.
```{r correlation PANU-SANU}
cor.test(nonuse$PANU, nonuse$SANU, method = "spearman")
```
- Correlation between PANU/EENU
```{r correlation PANU-EENU}
cor.test(nonuse$PANU, nonuse$EENU, method = "spearman")
```

### PANU-SANU relationship

```{r plot SANU-lm}
library(ggplot2)
ggplot(nonuse, aes(x=PANU, y=SANU)) +
  geom_point() +
  geom_smooth(method='lm', formula= y~x, color='blue', se=T) +
  # xlim(-10, 60) +
  # ylim(-50, 50) +
  
labs(title="PANU vs. SANU", x="PANU (%)", y="SANU (%)")
```

### PANU-EENU relationship

```{r plot EENU-lm}

ggplot(nonuse, aes(x=PANU, y=EENU)) +
  geom_point() +
  geom_smooth(method='lm', formula= y~x, color='blue', se=T) +
  # xlim(-10, 60) +
  # ylim(-50, 50) +
  
labs(title="PANU vs. EENU", x="PANU (%)", y="EENU (%)")
```

### Linear regression for PANU-SANU

```{r lm/SANU}
lm_sanu <- lm(SANU ~ PANU, data=nonuse)
summary(lm_sanu)
coef(lm_sanu)
slope_1 <- coef(lm_sanu)[2]
intercept_1 <- coef(lm_sanu)[1] #?
cat("Regression equation: SANU=", slope_1, "PANU +", intercept_1, "\n")
```

### Linear regression for PANU-EENU

```{r lm/EENU}
lm_eenu <- lm(EENU ~ PANU, data=nonuse)
summary(lm_eenu)
coef(lm_eenu)
slope_2 <- coef(lm_eenu)[2]
intercept_2 <- coef(lm_eenu)[1] 
cat("Regression equation: EENU=", slope_2, "PANU +", intercept_2, "\n")
```
## Regression equations
(PANU = a * SANU + b and PANU = a * EENU + b)

```{r equations PANU}
a <- 1 / slope_1
b <- -intercept_1 / slope_1

cat("Regression equation : PANU =", a, "* SANU +", b, "\n")

# PANU = a*EENU + b
a <- 1 / slope_2
b <- -intercept_2 / slope_2

cat("Regression equation : PANU =", a, "* EENU +", b, "\n")
```

## Results

Spearman’s rank correlation rho showed a weak but significant positive association between PANU and SANU (ρ = 0.216, p = 0.0017), while a moderate and significant positive association was found between PANU and EENU (ρ = 0.387, p < 0.0001). Linear regression analyses confirmed these results: no significant relationship was observed between SANU and PANU (SANU = 0.089 × PANU + 0.586, R² = 0.009, p = 0.171), whereas a significant positive relationship was found between EENU and PANU (EENU = 0.565 × PANU + 3.284, R² = 0.225, p < 0.0001). When PANU was expressed as a function of SANU and EENU, the regression equations obtained were PANU = 11.195 × SANU – 6.561 and PANU = 1.771 × EENU – 5.816,  respectively.
(with GPT's help)

## Limits

The present analysis has several limitations.
First, the correlations observed were relatively weak, with rho values of 0.216 for PANU–SANU and 0.387 for PANU–EENU, indicating that only a small proportion of the variance is explained.
Second, the linear regression between PANU and SANU was not significant (R² = 0.009, p = 0.171), and even the significant regression between PANU and EENU explained only a modest proportion of variance (R² = 0.225).
Third, the dataset contains a high number of missing values (223 for SANU and EENU, 13 for PANU), reducing statistical power and potentially biasing the analysis.
In addition, the variables show large variability and extreme values, which may reflect outliers or measurement noise.
Finally, the use of linear regression assumes a linear relationship, which may not fully capture the complexity of the data
(with GPT's help)

# Statistical tests: comparison of medians (or means?)

In this series of exercises, you will explore how to compare two groups of data, using non-parametric tests (or parametric tests… if it makes sense to do so).

2.1 Make clear what is a statistical test, and when to use it.
Below are some questions to guide your analysis. You can answer them in your notebook, with a short sentence for each question.

What is a median? A mean?
What is a variance? A standard deviation?
What is a normal distribution?
What is a statistical test?
When to use a statistical test?
What is a parametric test? A non-parametric test?
What are the assumptions of parametric tests?
What are the assumptions of non-parametric tests?
What is a p-value?
What is the risk of error when using a statistical test?
What is the difference between a paired and an unpaired test?
